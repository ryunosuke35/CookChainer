<div class="contain row">


  <aside class = "side_menu col-md-2">
    <%= search_form_for @q, url: index2_posts_path do |f| %>
      <%= f.label :name_cont, '料理名の検索' %>
      <%= f.search_field :name_cont %>
      <br>
      <%= f.submit '検索' %>
    <% end %>

    <%= form_with(url:index2_posts_path, local: true, method: :get) do |form| %>
      <%= form.select("id", Category.pluck(:name, :id), { include_blank: 'カテゴリで検索' }) %>
      <%= form.submit "検索する" %>
    <% end %>

    <% @tag_categories.each do |tag_category| %>
      <%= tag_category.name %>
      <% tag_category.tags.each do |tag| %>
        <%= tag.name %>
      <% end %>
    <% end %>
  </aside>


  <div class="cards col-md-10 row">
    <% @posts.each do |post| %>
      <section class="card col-md-3">
        <%= image_tag post.image.url, class: "card-img" if post.image.present?%>
        <div class="card-content">
          <h1 class="card-title"><%= link_to "#{post.name}", post_path(post) %></h1>
          <p class="card-text">
            <% post.tags.each do |tag| %>
              <%= tag.name %>
            <% end %>
          </p>
        </div>
        <div class="card-link">
          <% if post.user_id != current_user.id %>
            <% favorite = current_user.favorites.find_by(post_id: post.id) %>
            <% if favorite.present? %>
              <%= link_to 'お気に入り解除する', favorite_path(id: favorite.id), method: :delete %>
            <% else %>
              <%= link_to 'お気に入りする', favorites_path(post_id: post.id), method: :post %>
            <% end %>
          <% end %>
        </div>
      </section>
    <% end %>
  </div>


  <%= paginate @posts %>
</div>
